# Pyramid of Pain

## Introduction

![Pyramid of Pain](../_assets/THMPyramidOfPain.png "Pyramid of Pain")

## Hash Values (Trivial)

- hashes are unique numeric values generated by mathematical procedures
- used for identifying malicious artifacts
- virustotal and opswat do hash lookups

## IP Address (Easy)

- IP Addresses are a simple mechanism for filtering traffic that has historically been malicious
- IP Addresses also loosely correlate to geography, so some information can be gleaned about origin

## Domain Names (Simple)

- map of IP Address to string of text
- harder to manage for attackers
- punycode = conversion of ascii into unicode to decoy text
- URL shorteners hide malicious domains
	- type a "+" sign at the end of a shortened URL to see the real site name

## Host Artifacts (Annoying)

- observable items or changes on a host system left behind by attackers

## Network Artifacts (Annoying)

- patterns, packets, traffic, activity over a network by attackers

## Tools (Challenging)

- use AV signatures, detection rules, and YARA rules to stop/detect attackers
- MalwareBazaar and Malshare provide samples, malicious feeds, and YARA results
- SOC Prime Threat Detection Marketplace provides detection rules
- SSDeep provides fuzzy hashing tools
	- fuzzy hashing = analysis of files with minor differences 

## TTPs (Tough)

- stopping an ATP's TTPs will make it extremely difficult for them to compromise your assets without making wholesale changes to their attack methodologies


