# Vulnerability Assessment Tools

- you don't need to know every tool in detail, just when and how to use each class of tool

## Web Application Scanners

- scan from perspective of outside user
- only scan for vulnerabilities and exploits that have had a plug-in developed and installed
- given the broad usage of web app scanners, it would be useful to be able to develop specialized tests for your specific environment using the scanner's programming language

### OWASP Zed Attack Proxy (ZAP)

- OWASP = Open Web Application Security Project
- ZAP sits between user browser and web app collecting and modifying packets to test app responses

### Burp Suite

- map and analyze web app vulnerabilities
- combines automated and manual testing
- paid version offers greater automation

### Nikto

- focused on SQL and command injection, XSS, and misconfigurations
- CLI utility- no GUI
- fast if you know what you're doing

### Arachni

- speed-focused web scanner
- parallel scanning
- performs "meta-analysis" to reduce false positives
- needs only a target URL to start scanning

## Infrastructure Vulnerability Scanners

- modern scanners can only find vulnerabilities they know about; in order to know about a vulnerability, a plug-in or extension must be built and installed for it; as a scanner learns about tens of thousands of vulnerabilities, it grows to be an enormous size
- understand tradeoffs made between agent-based and server-based and between authenticated and unauthenticated

### Nessus

- created and maintained by Tenable
- 80k+ plug-ins
    - plug-ins are written using Nessus Attack Scripting Language (NASL)
    - Nessus subscription service offers updated plug-ins daily for vulnerabilities discovered within 24 hours
- can be accessed/controlled from browser
- can be aimed at one or multiple devices specified by IP or IP range with CIDR notation
- offers compliance checks
- details are included on each discovered vulnerability

### OpenVAS

- Open Vulnerability Assessment System = OpenVAS; includes vulnerability identification and management
- free and open source framework based on early Nessus project
- 47k+ network vulnerability test (NVTs)
- interface in browser
- provides details of detected vulnerabilities and confidence of detection

### Qualys

- Qualys is a security company
- QualysGuard is a vulnerability assessment and management SaaS product 
    - interface in browser
    - offers several report templates

## Software Assessment Tools and Techniques

- number of vulnerabilties correlates with software program size
- the following methods are used to detect software vulnerabilities:
    - static analysis
    - dynamic analysis
    - reverse engineering
    - fuzzing
- multiple assessment types should be used in tandem to decrease the number of missed vulnerabilities

### Static Analysis

- examining application code without executing it
- static analysis is done by automation, code review is done by humans
- OWASP **Lapse+** looks for vulnerabilities in java code
- static analysis by automation rarely uncovers runtime errors

### Dynamic Analysis

- what does the program *do*
- typical method is to sandbox the program and see what happens
- faster and cheaper, easier to perform

### Reverse Engineering

- turn an executable binary into higher level code to better understand it
- discover dependencies, expected input, inefficiencies and dangerous code

#### Engineering and Reverse Engineering

- programs are written in "high-level" code (Java, C#, etc.)
- these programs are then compiled (using a "compiler") into assembly language
- assembly language is then assembled (using an "assembler") into machine code
- machine code is run by the CPU
- reverse engineering reverses this process from machine code, to assembly, to high level code

### Fuzzing

- sending a lot of random and garbage input to program to make it break
- rarely purely random, common flaws are targeted - null input, overflow, mistyped data

#### untidy

- XML fuzzer
- transforms valid XML before inputting it

#### Peach Fuzzer

- uses XML modules called "pits"
- configurable; must have settings adjusted before testing

#### Microsoft SDL Fuzzers

- no longer supported
- fuzzers created by Microsoft to be part of SDLC toolset for verification phase

## Enumeration Tools and Techniques

- network scans look to determine what is open on a network
    - horizontal scans look for different available hosts
    - vertical scans look for different available ports on a single host

### nmap

- network mapper
- CLI or GUI options
    - Zenmap = Windows GUI
    - NmapFE = Linux GUI
    - Xnmap = MacOS GUI
- not the most rich scans, but offer very precise results and scripting extensions

### hping

- built on ping function
- offers packet analysis for TCP, UDP, ICMP
- traceroute functionality
- IP fragmentation

### Passive vs Active Enumeration Techniques

- passive enumeration - gain info without direct interaction
    - ex. whois, nslookup, dnsrecon
- active enumeration  - direct interfacing with target

### nslookup

- basically a DNS interface 
- resolves IP address of a host FQDN
    - can do reverse as well
- obtain DNS records/data

### responder

- poisons name services
    - gathers hashes and credentials within its network
- if a Windows host is unable to resolve a hostname with DNS, it falls back on LLMNR or NBT-NS
    - LLMNR = Link-Local Multicast Name Resolution
    - NBT-NS = NetBIOS-Name Service
    - both services are used to resolve hostnames from other clients on local network
- CLI tool

## Wireless Assessment Tools

- while networks are typically more secure when wireless isn't an option, implementing this policy is not usually feasible
- for WLAN analysis, WLAN interface card connects to wireless access point (WAP)
    - interfacing card is in client mode
    - WAP is in master mode
        - AKA infrastructure mode
        - interface card will have management permissions for all WLAN configs
    - mesh mode = allows interface to negotiate directly with interfaces in ad hoc mode
    - ad hoc mode = client interfaces with no master
    - monitor mode = see all available WLANs and their characteristics without joining them
- know your devices - keep track of your WAPs, know what is normal, know your settings and why they're there
- record your clients and authenticate
    - authenticate with WPA Enterprise and IEEE 802.1X

### Aircrack-ng

- open source suite of wireless tools for auditing WLAN security
- offers the following attacks:
    - WPA keys
    - replay attacks
    - deauthentication
    - fake access point creation
- with the right hardware:
    - wireless monitoring
    - wireless injection
    - packet captures

### Reaver

- wireless protocols have well known flaws
- Reaver takes advantage of WPS (Wi-Fi protected setup) feature
    - WPS uses a PIN which is split in half for validation
    - since the sample space is half the size, it is exponentially easier for Reaver to guess
- CLI tool
- attack can be prevented by disabling WPS feature which is not necessary for wireless network

### oclHashcat

- graphics card-optimized version of hashcat used for cracking passwords
    - graphics cards allow for lots of parallel processes
- supports the following attack modes:
    - brute-force attack - guess every combination until right one is found
    - combinator attack - combine different words/strings from dictionary to find password
    - dictionary attack - guess password using entries from a list of common passwords
    - hybrid attack - basically a combinator attack, one side is dictionary attack, the other is brute-force
    - mask attack - dictionary attack where certain placeholders are replaced with other chars
        - ex. dictionary entry is "password" mask attack might guess "p@$$w0rd"
    - rule-based attack - make guesses based on rules for password, so you might make a rule that says every password must be a certain length, have at least one digit, one uppercase, lowercase, etc.

## Cloud Infrastructure Assessment Tools

- cloud services have their own unique set of vulnerabilities
    - data spillage
    - instance takeover

### Scout Suite

- open source tool by NCC Group to determine security posture of cloud assets in GCP, AWS, and Azure
- works with platform API
- requires configuration for specific environment

### Prowler

- scalable and repeatable means to determine security readiness
- built for AWS platform
- checks for best practices divided into the following groups:
    - IAM
    - Logging
    - Monitoring
    - Networking
    - CIS Level 1
    - CIS Level 2
    - Forensics
    - GDPR
    - HIPAA

### Pacu

- built by Rhino Security Labs for AWS
- easy to build on
- open source on GitHub
- used in pentesting and compliance assurance
