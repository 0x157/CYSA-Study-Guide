# Vulnerability Management Activities

## Vulnerability Identification

- vulnerability scanning = automation of security checks against org's systems; point out weaknesses in system
  - key aspect of network security
  - single purpose tools, do not analyze context, can't chain exploits (so a bunch of small vulnerabilities that can create a big hole only appear as small vulnerabilities), they don't act like an attacker- they act like an automated system searching for a predetermined list of potential vulnerabilities

### Regulatory Environments

- many organizations are forced to operate under the control of laws, rules, and regulations of governments, industry groups, or other regulatory bodies
- orgs within regulatory environments generally have to deal with compliance in some way, and that compliance often has a security aspect

#### ISO/IEC 27001 Standard

- The International Organization for Standardization (ISO) and the International Electrotechnical Commission (IEC) jointly maintain this standard on Information Security Management Systems (ISMS)
- VERY common voluntary standard
- three stages of certification:
  1. desk-side audit to ensure documentation for vulnerability management
  2. implementation audit to ensure documentation is followed
  3. surveilance audit ensures that implementation is continued

#### Payment Card Industry Data Security Standard (PCI DSS)

- applies to all orgs who process credit card payments from the five major issuers:
  - Visa
  - Mastercard
  - Amex
  - Discover
  - JCB
- requirement 11 focuses on regular testing of security systems and processes
  - requires internal and external scans every quarter and whenever significant changes are implemented
  - high risk vulernabilities must be resolved

#### Health Insurance Portability and Accountability Act (HIPAA)

- creates penalties for failure to protect protected health information (PHI)
- requires orgs to conduct vulnerability assessments and implement reasonable security measures

#### Corporate Security Policy

- high level statement of security policy within an org established by senior management
- accompanied by issue-specific and system-specific security policies that prescribe security implementations at a slightly more detailed level with smaller scope

### Data Classification

- classification tag specifies sensitivity of data to which it is attached
- outside of the government, data classification levels are specified at a company-level
  - additional governance exists for classified data for government and contractor data that are not included here
- common levels include the following:
  - private - could raise personal privacy concerns
  - confidential - data could seriously damage organization
  - proprietary (or sensitive) = data could cause some damage, not major
  - public - no adverse effect of release
- classification levels should not overlap
- classification levels should consider the following factors:
  - level of damage caused by disclosure
  - level of damage caused by loss of integrity
  - lost opportunities
  - regulatory requirements
  - data age
  - relevance of data to security posture

### Asset Inventory

- you can't protect what you don't know about
- inventory includes anything of value to an org
  - determining value tends to be more difficult than establishing inventory

#### Servers

- losing track of everything on a server leaves it vulnerable to attacks on obscure pre-installed apps (*cough cough* Windows Server *cough*)
- misconfigurations and ignoring unused features leaves servers vulnerable to exploits on those services
  - need everything you use and secure everything you use and remove the dross because it just provides more attack surface
- shadow IT = unmonitored activities by other members of an org to add functionality that security and sys admin teams are unaware of and thus don't secure

#### Endpoints

- devices used by end-users
- most common entry point into a network
- the decentralized, unmanaged distribution and use of these devices has historically made them a very weak point for many security operations

#### Critical Assets

- everything needed to perform essential functions of an org
- must be heavily defended because the org relies on them for revenue

#### Noncritical Assets

- not imperative for successful security operation
- lower priority than critical assets
- always consider the business implications of security decisions

### Active vs Passive Scanning 

- scanning = method to learn about a network/system/device through its responses
- scanner come in one of three flavors:
  1. network mappers
  2. host/port scanners
  3. web app vulnerability scanners
- (not from book:) active scanning = poke the devices and see what comes back
- (also not from book:) passive scanning = monitor what happens on a network or system without stimulating it directly

### Mapping/Enumeration

- network mapping aims to understand network layout (topology discovery): 
  - perimeter networks
  - demilitarized zones (DMZs)
  - key network devices
- steps for mapping: 
  - sweep the network - see what devices are online; commonly done with *NMap*
  - after a sweep an attacker may make a second pass to fill in details on interesting results

#### Port Scanning

- port scanners = programs for probing open ports on a host
- used for service discovery
- OS may be inferred based on OS fingerprinting done by some port scanners (not always reliably)

#### Web App Vulnerability Scanning

- web app vulnerability scanner = automated tool for scanning web apps for security vulnerabilities including SQLi, CSRF, command injection, and improper server configs, among others
- additional features for these scanners may be implemented with plug-ins and APIs
- these scanners have become commonly used by genuine attackers, not just red teamers

## Scanning Parameters and Criteria

- no single solution as to optimal scanning frequency - it's about the why
  - make the calculations up front about when is best for the business, how often is sufficient, and so on
  - setting up periodic rather than ad hoc scans also provides you with a better understanding of exactly what you security posture is

### Risks Associated with Scanning Activities

- risk appetite = amount of risk a business is willing to accept
  - find the balance between acceptable risk and acceptable resource expenditure to minimize those risks
  - risk can never be zero, so there must be some tradeoff

### Regulatory Requirements

- scanning frequency requirements may be handed to you by regulations
- semiannual scans are considered a **minimum** by industry experts
  - probably as a condition of "acceptable security"

### Technical Constraints

- security operations are constrained by a number of factors: personnel, time, compute, etc.
- technical constraints are those on personnel and computational resources like memory space or compute time
  - identifying constraints is a good first step
  - increasing scans is possible when constraints are greater than the current operation uses

### Workflow

- 